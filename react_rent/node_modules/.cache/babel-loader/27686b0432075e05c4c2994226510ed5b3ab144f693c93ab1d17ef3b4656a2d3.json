{"ast":null,"code":"import { useRef } from 'react';\nvar useRetryPlugin = function useRetryPlugin(fetchInstance, _a) {\n  var retryInterval = _a.retryInterval,\n    retryCount = _a.retryCount;\n  var timerRef = useRef();\n  var countRef = useRef(0);\n  var triggerByRetry = useRef(false);\n  if (!retryCount) {\n    return {};\n  }\n  return {\n    onBefore: function onBefore() {\n      if (!triggerByRetry.current) {\n        countRef.current = 0;\n      }\n      triggerByRetry.current = false;\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n      }\n    },\n    onSuccess: function onSuccess() {\n      countRef.current = 0;\n    },\n    onError: function onError() {\n      countRef.current += 1;\n      if (retryCount === -1 || countRef.current <= retryCount) {\n        // Exponential backoff\n        var timeout = retryInterval !== null && retryInterval !== void 0 ? retryInterval : Math.min(1000 * Math.pow(2, countRef.current), 30000);\n        timerRef.current = setTimeout(function () {\n          triggerByRetry.current = true;\n          fetchInstance.refresh();\n        }, timeout);\n      } else {\n        countRef.current = 0;\n      }\n    },\n    onCancel: function onCancel() {\n      countRef.current = 0;\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n      }\n    }\n  };\n};\nexport default useRetryPlugin;","map":{"version":3,"names":["useRef","useRetryPlugin","fetchInstance","_a","retryInterval","retryCount","timerRef","countRef","triggerByRetry","onBefore","current","clearTimeout","onSuccess","onError","timeout","Math","min","pow","setTimeout","refresh","onCancel"],"sources":["E:/Github/react_rent/react_rent/node_modules/ahooks/es/useRequest/src/plugins/useRetryPlugin.js"],"sourcesContent":["import { useRef } from 'react';\nvar useRetryPlugin = function useRetryPlugin(fetchInstance, _a) {\n  var retryInterval = _a.retryInterval,\n    retryCount = _a.retryCount;\n  var timerRef = useRef();\n  var countRef = useRef(0);\n  var triggerByRetry = useRef(false);\n  if (!retryCount) {\n    return {};\n  }\n  return {\n    onBefore: function onBefore() {\n      if (!triggerByRetry.current) {\n        countRef.current = 0;\n      }\n      triggerByRetry.current = false;\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n      }\n    },\n    onSuccess: function onSuccess() {\n      countRef.current = 0;\n    },\n    onError: function onError() {\n      countRef.current += 1;\n      if (retryCount === -1 || countRef.current <= retryCount) {\n        // Exponential backoff\n        var timeout = retryInterval !== null && retryInterval !== void 0 ? retryInterval : Math.min(1000 * Math.pow(2, countRef.current), 30000);\n        timerRef.current = setTimeout(function () {\n          triggerByRetry.current = true;\n          fetchInstance.refresh();\n        }, timeout);\n      } else {\n        countRef.current = 0;\n      }\n    },\n    onCancel: function onCancel() {\n      countRef.current = 0;\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n      }\n    }\n  };\n};\nexport default useRetryPlugin;"],"mappings":"AAAA,SAASA,MAAM,QAAQ,OAAO;AAC9B,IAAIC,cAAc,GAAG,SAASA,cAAc,CAACC,aAAa,EAAEC,EAAE,EAAE;EAC9D,IAAIC,aAAa,GAAGD,EAAE,CAACC,aAAa;IAClCC,UAAU,GAAGF,EAAE,CAACE,UAAU;EAC5B,IAAIC,QAAQ,GAAGN,MAAM,EAAE;EACvB,IAAIO,QAAQ,GAAGP,MAAM,CAAC,CAAC,CAAC;EACxB,IAAIQ,cAAc,GAAGR,MAAM,CAAC,KAAK,CAAC;EAClC,IAAI,CAACK,UAAU,EAAE;IACf,OAAO,CAAC,CAAC;EACX;EACA,OAAO;IACLI,QAAQ,EAAE,SAASA,QAAQ,GAAG;MAC5B,IAAI,CAACD,cAAc,CAACE,OAAO,EAAE;QAC3BH,QAAQ,CAACG,OAAO,GAAG,CAAC;MACtB;MACAF,cAAc,CAACE,OAAO,GAAG,KAAK;MAC9B,IAAIJ,QAAQ,CAACI,OAAO,EAAE;QACpBC,YAAY,CAACL,QAAQ,CAACI,OAAO,CAAC;MAChC;IACF,CAAC;IACDE,SAAS,EAAE,SAASA,SAAS,GAAG;MAC9BL,QAAQ,CAACG,OAAO,GAAG,CAAC;IACtB,CAAC;IACDG,OAAO,EAAE,SAASA,OAAO,GAAG;MAC1BN,QAAQ,CAACG,OAAO,IAAI,CAAC;MACrB,IAAIL,UAAU,KAAK,CAAC,CAAC,IAAIE,QAAQ,CAACG,OAAO,IAAIL,UAAU,EAAE;QACvD;QACA,IAAIS,OAAO,GAAGV,aAAa,KAAK,IAAI,IAAIA,aAAa,KAAK,KAAK,CAAC,GAAGA,aAAa,GAAGW,IAAI,CAACC,GAAG,CAAC,IAAI,GAAGD,IAAI,CAACE,GAAG,CAAC,CAAC,EAAEV,QAAQ,CAACG,OAAO,CAAC,EAAE,KAAK,CAAC;QACxIJ,QAAQ,CAACI,OAAO,GAAGQ,UAAU,CAAC,YAAY;UACxCV,cAAc,CAACE,OAAO,GAAG,IAAI;UAC7BR,aAAa,CAACiB,OAAO,EAAE;QACzB,CAAC,EAAEL,OAAO,CAAC;MACb,CAAC,MAAM;QACLP,QAAQ,CAACG,OAAO,GAAG,CAAC;MACtB;IACF,CAAC;IACDU,QAAQ,EAAE,SAASA,QAAQ,GAAG;MAC5Bb,QAAQ,CAACG,OAAO,GAAG,CAAC;MACpB,IAAIJ,QAAQ,CAACI,OAAO,EAAE;QACpBC,YAAY,CAACL,QAAQ,CAACI,OAAO,CAAC;MAChC;IACF;EACF,CAAC;AACH,CAAC;AACD,eAAeT,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}