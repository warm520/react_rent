"use strict";

var __importDefault = this && this.__importDefault || function (mod) {
  return mod && mod.__esModule ? mod : {
    "default": mod
  };
};
Object.defineProperty(exports, "__esModule", {
  value: true
});
var useLatest_1 = __importDefault(require("../useLatest"));
var domTarget_1 = require("../utils/domTarget");
var getDocumentOrShadow_1 = __importDefault(require("../utils/getDocumentOrShadow"));
var useEffectWithTarget_1 = __importDefault(require("../utils/useEffectWithTarget"));
function useClickAway(onClickAway, target, eventName) {
  if (eventName === void 0) {
    eventName = 'click';
  }
  var onClickAwayRef = (0, useLatest_1["default"])(onClickAway);
  (0, useEffectWithTarget_1["default"])(function () {
    var handler = function handler(event) {
      var targets = Array.isArray(target) ? target : [target];
      if (targets.some(function (item) {
        var targetElement = (0, domTarget_1.getTargetElement)(item);
        return !targetElement || targetElement.contains(event.target);
      })) {
        return;
      }
      onClickAwayRef.current(event);
    };
    var documentOrShadow = (0, getDocumentOrShadow_1["default"])(target);
    var eventNames = Array.isArray(eventName) ? eventName : [eventName];
    eventNames.forEach(function (event) {
      return documentOrShadow.addEventListener(event, handler);
    });
    return function () {
      eventNames.forEach(function (event) {
        return documentOrShadow.removeEventListener(event, handler);
      });
    };
  }, Array.isArray(eventName) ? eventName : [eventName], target);
}
exports["default"] = useClickAway;